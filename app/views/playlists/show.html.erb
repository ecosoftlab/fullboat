<% content_for :head do %>
	<%= auto_discovery_link_tag(:rss, formatted_playlist_path(@playlist, :rss)) %>
<% end %>

<% content_for :record do %>
  <ul>
    <li><%= link_to("View Enlarged for Radio", formatted_playlist_path(@playlist, :enlarged))%></li>
  </ul>
<% end %>

<% content_for :section do %>
    <h3>Music</h3>
    <ul>
      <li><%= link_to_unless_current "Artists", artists_path %></li>
      <li><%= link_to_unless_current "Albums",  albums_path %></li>
      <li><%= link_to_unless_current "Labels",  labels_path %></li>
      <li><%= link_to_unless_current "Genres",  genres_path %></li>
    </ul>
    
    <h3>Production</h3>
    <ul>
      <li><%= link_to_unless_current "Schedules", schedules_path %></li>
      <li><%= link_to_unless_current "Programs",  programs_path %></li>
      <li><%= link_to_unless_current "PSAs",      psas_path %></li>
      <li><%= link_to_unless_current "Promos",    promos_path %></li>
    </ul>
<% end %>

<div class="column span-10">
<% if @playlist.program %>
  <h1>Playlist for <%= h @playlist.program %></h1>
<% else %>
  <h1>Random Playlist</h1>
<% end %>
<h2><%= @playlist.starts_at.to_ordinalized_s(:mdy) %></h2>
</div>
<div class="column span-7 last">
<% remote_form_for(:playlist, :url => playlists_path) do |f| %>
  <fieldset id="playlist-details">
  	<ol>
  		<li>
  	    	<label for="starts_at">Start Time</label>
  	    	<%= f.time_select :starts_at %>
  		</li>
  		<li>
  	    	<label for="ends_at">End Time</label>
  	    	<%= f.time_select :ends_at %>
  		</li>
  	</ol>
  </fieldset>
<% end %>
</div>

<hr />

<table>
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>Name</th>
      <th></th>
      <th>Time</th>
      <th colspan="2"></th>
    </tr>
  </thead>
  
  <tbody id="plays">
    <%= render(:collection => @playlist.plays, :partial => 'plays/summary/row') %>
  </tbody>
</table>

<%= sortable_element "plays", 
                      :handle => 'handle',
                      :tag    => :tr,
                      # :update => "sort-status",
                      # :loading => visual_effect(:fade, "sort-status-alert", :duration => 0.1), 
                      # :complete => visual_effect(:appear, "sort-status-alert"), 
                      :url => '/' %>

<% remote_form_for(:play, :url => playlist_plays_path(@playlist), :html => {:id => 'play_form'}) do |f| %>
  <div id="error" class="alert error" style="display:none;"></div>
  <fieldset class="padded">
    <select id="type" name="type" class="column span-5" onchange="$$('.panel').invoke('hide'); Element.show($F(this));">
      <optgroup label=""> 
        <option value="album-track">Album Track</option>
        <option value="psa">PSA</option>
        <option value="promo">Promo</option>
        <option value="comment">Comment</option>
      </optgroup>
      <optgroup label="Protocol">
        <option value="station-id">Station ID</option>
        <option value="radio-calendar">Radio Calendar</option>
      </optgroup>
    </select>
    
    <fieldset class="column span-5 prepend-1">
      <label>Timestamp</label>
      <%= f.time_select :created_at %>
    </fieldset>
    
    <fieldset class="column span-3 prepend-1 last">
      <%= submit_tag "Add to Playlist" %>
    </fieldset>
    
    <hr class="space">
        
    <fieldset class="column span-8">
      <fieldset id="album-track" class="panel">
        <ol>
          <li class="artist">
            <label>Artist</label>
            <%= text_field_with_auto_complete :artist, :name, 
                  { :class => 'title' },
    				      { :skip_style => true, :indicator => "loading-indicator" } %>
    				<%= loading_indicator %>
  				
    				<%= observe_field 'artist_name', :update => 'album',
    				                  :frequency => 1.0,
                              :with => "artist", 
                              :url => { :controller => "playlists",
                                        :action     => "remote_update_albums" } %>
          </li>
          <li class="album">
            <label>Album</label>
            <%= select_tag :album %>
					
  					<%= observe_field 'album', :update => 'track',
    				                  :frequency => 1.0,
                              :with => "album", 
                              :url => { :controller => "playlists",
                                        :action     => "remote_update_tracks" } %>
          </li>                  
          <li class="track">        
            <label>Track</label> 
            <%= select_tag :track %>
          </li>
        </ol>
      </fieldset>
  
  
      <fieldset id="psa" class="panel" style="display:none;">
        <ol>
          <li>
            <label>PSA ID</label>
            <%= text_field :psa, :code %>
          </li>
          <li>
            <label>Duration</label>
            <%= select :psa, :duration, [':15', ':30', ':45', '1:00']%>
          </li>
          <li>
              <label class="inline column span-3"><%= radio_button :psa, :live, true %> Live</label>
              <label class="inline column span-3"><%= radio_button :psa, :live, false %> Recorded</label>
          </li>
        </ol>
      </fieldset>
  
      <fieldset id="promo" class="panel" style="display:none;">
        <ol>
          <li>
            <label>Promo ID</label>
            <%= text_field :promo, :code %>
          </li>
        </ol>
      </fieldset>
    
      <fieldset id="station-id" class="panel" style="display:none;">
        <p>WRCT Pittsburgh</p>
      </fieldset>
    
      <fieldset id="radio-calendar" class="panel" style="display:none;">
        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
      </fieldset>
    
      <fieldset id="comment" class="panel" style="display:none;">
        <ol>
          <li>
            <label>Comment</label>
            <%= text_area :comment, :body %>
          </li>
        </ol>
      </fieldset>
    </fieldset>
  </fieldset>

<% end %>